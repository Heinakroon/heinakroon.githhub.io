<!DOCTYPE html>
<html>
	<head>
	<title>Heinakroon: 24 [settings]</title>
	<link rel="stylesheet" type="text/css" href="css/slate.min.css">
	<script src="js/slate.min.js"></script>
	<style>
	.title {
		/*padding: 15px 10px;*/
		text-transform: uppercase;
		font-family: "PT Sans", sans-serif;
		font-size: 1.2em;
		line-height: 1.3;
		font-weight: 500;
		color: #888;
		text-align: center;
	}
	.title h2 {
		text-transform: initial;
		font-size: .8em;
	}
	.title h2:before {
		content: "";
		display: inline-block;
		position: relative;
		top: 4px;
		right: 10px;
		width: 48px;
		height: 48px;
		background: transparent url(img/heinakroon.svg) top left no-repeat;
		background-size: 48px 48px;
	}
	</style>
	</head>

	<body>
		<hgroup class="title">
		<h1>settings: '24'</h1>
		<h2>Heinakroon</h2>
	</hgroup>

		<div class="item-container">
			<div class="item-container-content">
				<p class="item">
					Use this configuration page to choose the settings you would like applied to this app.
				</p>
			</div>
		</div>

		<section class="item-container">
			<h1 class="item-container-header">Customizability</h1>
			<div class="item-container-content">
				<label class="item">
					Background Color
					<input id="background_color_picker" type="text" class="item-color item-color-sunny" value="#000000">
				</label>
			</div>
			<div class="item-container-footer">
				Choose the app"s background color. Used if High Contrast Mode is not selected. Note: Only available on Basalt watches that support many colors.
			</div>
		</section>

		<div class="item-container">
			<div class="item-container-header">Accessibility</div>
			<div class="item-container-content">
				<label class="item">
					High Contrast Mode
					<input id="high_contrast_checkbox" type="checkbox" class="item-toggle">
				</label>
			</div>
			<div class="item-container-footer">
				This switches the app colors to a higher contrast set that promotes readability in low light.
			</div>
		</div>

		<div class="item-container">
			<div class="button-container">
				<input id="submit_button" type="button" class="item-button" value="SUBMIT">
			</div>
		</div>
	</body>
	<script>
	function getConfigData() {
		var backgroundColorPicker = document.getElementById("background_color_picker");
		var highContrastCheckbox = document.getElementById("high_contrast_checkbox");
 
		var options = {
			"background_color": backgroundColorPicker.value,
			"high_contrast": highContrastCheckbox.checked
		};

		// Save for next launch
		localStorage["background_color"] = options["background_color"];
		localStorage["high_contrast"] = options["high_contrast"];

		console.log("Got options: " + JSON.stringify(options));
		return options;
	}

	function getQueryParam(variable, defaultValue) {
		var query = location.search.substring(1);
		var vars = query.split("&");
		for (var i = 0; i < vars.length; i++) {
			var pair = vars[i].split("=");
			if (pair[0] === variable) {
				return decodeURIComponent(pair[1]);
			}
		}
		return defaultValue || false;
	}
 
	var submitButton = document.getElementById("submit_button");
	submitButton.addEventListener("click", function() {
		console.log("Submit");

		// Set the return URL depending on the runtime environment
		var return_to = getQueryParam("return_to", "pebblejs://close#");
		document.location = return_to + encodeURIComponent(JSON.stringify(getConfigData()));
	});

	(function() {
		var backgroundColorPicker = document.getElementById("background_color_picker");
		var highContrastCheckbox = document.getElementById("high_contrast_checkbox");

		// Load any previously saved configuration, if available
		if(localStorage["high_contrast"]) {
			highContrastCheckbox.checked = JSON.parse(localStorage["high_contrast"]);
			backgroundColorPicker.value = localStorage["background_color"];
		}
	})();
	</script>
</html>